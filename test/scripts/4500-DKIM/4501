# DKIM verify, simple canonicalisation, with spaces
#
exim -DSERVER=server -bd -oX PORT_D
****
#
# this should pass verification
# Mail original in aux-fixed/4501.msg1.txt
# Sig generated by: perl aux-fixed/dkim/sign.pl --method=simple/simple < aux-fixed/4501.msg1.txt
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<pass@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha1; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=pdsXC6mnKSmAYjraebHb2Tt2xqw=; b=
	bE9pnPdz5eDwz58PFMAsiFqpcsel33p5+pnvhwY5D6B6suGFbvku+LC1pi77z3lq
	45mFRxT4Dr4rW4612jYi5WpNk8ed28BkNMowUCgkM2TDoktiRClFpXTUX00hCico
	KWcgcvORf6L8txhtICsHsl94ERKXxgptXHQk8XwMEuU=
From: mrgus@test.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple space test

This is a test of simple with spaces.

   

End of content (spaced line two lines down).
.
??? 250
QUIT
??? 221
****
#
# this should fail verification
# Same message and sig as above, but body extended with (emptyline) (line with only spaces) (emptyline)
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<fail@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha1; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=pdsXC6mnKSmAYjraebHb2Tt2xqw=; b=
	bE9pnPdz5eDwz58PFMAsiFqpcsel33p5+pnvhwY5D6B6suGFbvku+LC1pi77z3lq
	45mFRxT4Dr4rW4612jYi5WpNk8ed28BkNMowUCgkM2TDoktiRClFpXTUX00hCico
	KWcgcvORf6L8txhtICsHsl94ERKXxgptXHQk8XwMEuU=
From: mrgus@test.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple space test

This is a test of simple with spaces.

   

End of content (spaced line two lines down).

    

.
??? 250
QUIT
??? 221
****
#
killdaemon
no_stdout_check
no_msglog_check
