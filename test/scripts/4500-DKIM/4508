# DKIM verify, dkim_verify_signers option
#
exim -DSERVER=server -DDYNAMIC_OPTION='$dkim_signers' -bd -oX PORT_D
****
#
# Same as default. This should pass.
#  - sha256, 1024b
# Mail original in aux-fixed/4500.msg1.txt
# Sig generated by: perl aux-fixed/dkim/sign.pl --algorithm=rsa-sha256 \
#			--method=simple/simple < aux-fixed/4500.msg1.txt
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<CALLER@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=3UbbJTudPxmejzh7U1Zg33U3QT+1
	6kfV2eOTvMeiEis=; b=xQSD/JMqz0C+xKf0A1NTkPTbkDuDdJbpBuyjjT9iYvyP
	Zez+xl0TkoPobFGVa6EN8+ZeYV18zjifhtWYLSsNmPinUtcpKQLG1zxAKmmS0JEh
	+qihlWbeGJ5+tK588ugUzXHPj+4JBW0H6kxHvdH0l2SlQE5xs/cdggnx5QX5USY=
From: mrgus@text.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple test

This is a simple test.
.
??? 250
QUIT
??? 221
****
killdaemon
#
exim -DSERVER=server -DDYNAMIC_OPTION='' -bd -oX PORT_D
****
# Empty.  Should avoid calling dkim ACL.
#  - sha256, 1024b
# Mail original in aux-fixed/4500.msg1.txt
# Sig generated by: perl aux-fixed/dkim/sign.pl --algorithm=rsa-sha256 \
#			--method=simple/simple < aux-fixed/4500.msg1.txt
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<CALLER@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=3UbbJTudPxmejzh7U1Zg33U3QT+1
	6kfV2eOTvMeiEis=; b=xQSD/JMqz0C+xKf0A1NTkPTbkDuDdJbpBuyjjT9iYvyP
	Zez+xl0TkoPobFGVa6EN8+ZeYV18zjifhtWYLSsNmPinUtcpKQLG1zxAKmmS0JEh
	+qihlWbeGJ5+tK588ugUzXHPj+4JBW0H6kxHvdH0l2SlQE5xs/cdggnx5QX5USY=
From: mrgus@text.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple test

This is a simple test.
.
??? 250
QUIT
??? 221
****
killdaemon
#
exim -DSERVER=server -DDYNAMIC_OPTION='nothere.example.com' -bd -oX PORT_D
****
# Different domain.  Should fail DKIM verify.
#  - sha256, 1024b
# Mail original in aux-fixed/4500.msg1.txt
# Sig generated by: perl aux-fixed/dkim/sign.pl --algorithm=rsa-sha256 \
#			--method=simple/simple < aux-fixed/4500.msg1.txt
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<CALLER@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=3UbbJTudPxmejzh7U1Zg33U3QT+1
	6kfV2eOTvMeiEis=; b=xQSD/JMqz0C+xKf0A1NTkPTbkDuDdJbpBuyjjT9iYvyP
	Zez+xl0TkoPobFGVa6EN8+ZeYV18zjifhtWYLSsNmPinUtcpKQLG1zxAKmmS0JEh
	+qihlWbeGJ5+tK588ugUzXHPj+4JBW0H6kxHvdH0l2SlQE5xs/cdggnx5QX5USY=
From: mrgus@text.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple test

This is a simple test.
.
??? 250
QUIT
??? 221
****
killdaemon
#
exim -DSERVER=server -DDYNAMIC_OPTION='test.ex : different.example.com' -bd -oX PORT_D
****
# Mixed set.  Should get one DKIM verify pass.
#  - sha256, 1024b
# Mail original in aux-fixed/4500.msg1.txt
# Sig generated by: perl aux-fixed/dkim/sign.pl --algorithm=rsa-sha256 \
#			--method=simple/simple < aux-fixed/4500.msg1.txt
client 127.0.0.1 PORT_D
??? 220
HELO xxx
??? 250
MAIL FROM:<CALLER@bloggs.com>
??? 250
RCPT TO:<a@test.ex>
??? 250
DATA
??? 354
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=test.ex; h=from:to
	:date:message-id:subject; s=sel; bh=3UbbJTudPxmejzh7U1Zg33U3QT+1
	6kfV2eOTvMeiEis=; b=xQSD/JMqz0C+xKf0A1NTkPTbkDuDdJbpBuyjjT9iYvyP
	Zez+xl0TkoPobFGVa6EN8+ZeYV18zjifhtWYLSsNmPinUtcpKQLG1zxAKmmS0JEh
	+qihlWbeGJ5+tK588ugUzXHPj+4JBW0H6kxHvdH0l2SlQE5xs/cdggnx5QX5USY=
From: mrgus@text.ex
To: bakawolf@yahoo.com
Date: Thu, 19 Nov 2015 17:00:07 -0700
Message-ID: <qwerty1234@disco-zombie.net>
Subject: simple test

This is a simple test.
.
??? 250
QUIT
??? 221
****
killdaemon
#
no_stdout_check
no_msglog_check
