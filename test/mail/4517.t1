From someone@some.domain Tue Mar 02 09:44:33 1999
Received: from the.local.host.name ([ip4.ip4.ip4.ip4] helo=test.ex)
	by test.ex with esmtp (Exim x.yz)
	(envelope-from <someone@some.domain>)
	id 10HmaY-000000005vi-0000
	for rewrite@test.ex;
	Tue, 2 Mar 1999 09:44:33 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=test.ex;
	s=sel; h=From:Subject:To:Sender:Reply-To:Date:Message-ID:Cc:MIME-Version:
	Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
	List-Post:List-Owner:List-Archive;
	bh=fdkeB/A0FkbVP2k4J4pNPoeWH6vqBm9+b0C3OY87Cw8=; b=T+jvYUTh9JEkb2ev91FCTYRlHr
	tTDMekPWwBW6E5jKwxG9zaEYfmcBcrwdU97KABzbt8hpp+2n/bHnMiQ2UrP37T0bBqkmLxDi0ruau
	WZ3sn/Omyo6WZktvkjDT22hdpvr9u0QpP3Xc692p7diNHdLWjR23iS7V8/pi8ufbb5sY=;
Received: from [127.0.0.1] (helo=tester)
	by test.ex with esmtp (Exim x.yz)
	(envelope-from <someone@some.domain>)
	id 10HmaX-000000005vi-0000
	for rewrite@test.ex;
	Tue, 2 Mar 1999 09:44:33 +0000
To: CALLER@test.ex
Subject: This is just a very, very, very long subject  in front of the From: header that
 should grow the deliver_out_buffer up to a size so that adding the From: header
 after rewrite_header() will trigger header flushing. Together with the Received
 header added by exim the all headers until From: must have a length less than .
 DELIVER_OUT_BUFFER_SIZE (default 8192) but engough so that we exceed ..........
 DELIVER_OUT_BUFFER_SIZE - nl_escape_length - 2 (see transport.c:452) ..........
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
 123456789
From: Very, very long from header to increase the chance that a header flush happens after rewrite_header() which causes a memory corruption <someone@some.domain>

Test

